---
title: Too Many Open Files
description: Resolve "too many open files" errors by adjusting concurrent requests or system limits.
---

import { Aside } from "@astrojs/starlight/components";

The "too many open files" error occurs when lychee exhausts available file handles. Each network request uses a socket, represented as a file on UNIX systems.

Error message:

```bash
error trying to connect: tcp open error: Too many open files (os error 24)
```

lychee's default concurrency is 128, meaning up to 128 simultaneous network connections. Systems with low file handle limits can't support this many open files.

## Reduce Concurrent Requests

Lower the concurrency to stay within system limits:

```bash
lychee --max-concurrency 50 https://example.com
```

<Aside type="caution">Lower concurrency reduces performance</Aside>

Experiment with values between 10 and 100 to find the right balance for your system.

## Increase System Limits

### UNIX/Linux/macOS

Check current limit:

```bash
ulimit -n
```

Increase for the current shell session:

```bash
ulimit -n 4096
```

<Aside>This only affects the current shell session</Aside>

### Permanent Increase (macOS)

Set system-wide limits with `launchctl`:

```bash
sudo launchctl limit maxfiles 4096 unlimited
```

Then apply per-session:

```bash
ulimit -n 4096
```

This sets a soft limit of 4096 and removes the hard cap.

For persistent boot changes, create `/Library/LaunchDaemons/limit.maxfiles.plist` with appropriate XML configuration. See [Apple documentation](https://support.apple.com/) for details.

<Aside>Restart your terminal or system for changes to take effect</Aside>

### Permanent Increase (Linux)

Edit `/etc/security/limits.conf`:

```bash
* soft nofile 4096
* hard nofile 8192
```

Or for a specific user:

```bash
username soft nofile 4096
username hard nofile 8192
```

Logout and login for changes to take effect.

### Windows

Windows handles file limits differently. The error typically indicates port exhaustion rather than file handle limits.

Increase available ports via Registry Editor:

1. Open Registry Editor (`regedit`)
2. Navigate to `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters`
3. Create `DWORD` value `MaxUserPort` = `65534`
4. Create `DWORD` value `TcpTimedWaitDelay` = `30`
5. Restart your computer

<Aside type="caution">
  Back up your registry before making changes. Incorrect modifications can cause system instability.
</Aside>

## Configuration File

```toml title="lychee.toml"
max_concurrency = 50
```

## Recommended Values

- **Low-end systems**: 20-50 concurrent requests
- **Standard systems**: 50-100 concurrent requests
- **High-end systems**: 100-200 concurrent requests

Start conservatively and increase if no errors occur.
