---
title: Library Usage
---

You can use lychee as a library for your own projects!
The documentation for the library can be found at [docs.rs/lychee-lib](https://docs.rs/lychee-lib).

## Setup

Add `lychee-lib` to your `Cargo.toml`:

```toml
[dependencies]
lychee-lib = "0.16"
tokio = { version = "1", features = ["full"] }
```

## Basic Example

```rust title="main.rs"
use lychee_lib::Result;

#[tokio::main]
async fn main() -> Result<()> {
    let response = lychee_lib::check("https://github.com/lycheeverse/lychee").await?;
    println!("{response}");
    Ok(())
}
```

## Using the Client

```rust title="main.rs"
use lychee_lib::{ClientBuilder, Result, Status};

#[tokio::main]
async fn main() -> Result<()> {
    let client = ClientBuilder::default().client()?;
    let response = client.check("https://github.com/lycheeverse/lychee").await?;
    
    if response.status().is_success() {
        println!("✓ Link is valid!");
    } else {
        println!("✗ Link is broken: {:?}", response.status());
    }
    
    Ok(())
}
```

## Customizing the Client

```rust title="main.rs"
use lychee_lib::ClientBuilder;
use std::time::Duration;

let client = ClientBuilder::builder()
    .user_agent("my-link-checker/1.0")
    .max_redirects(10)
    .timeout(Duration::from_secs(30))
    .allow_insecure(false)
    .build()
    .client()?;
```

### Available Options

- `includes()` - Include only URLs matching patterns
- `excludes()` - Exclude URLs matching patterns  
- `max_redirects()` - Maximum number of redirects to follow
- `user_agent()` - Custom user agent string
- `allow_insecure()` - Allow invalid SSL certificates
- `custom_headers()` - Add custom HTTP headers
- `method()` - HTTP method to use (GET, HEAD, etc.)
- `timeout()` - Request timeout duration
- `github_token()` - GitHub token for API requests
- `scheme()` - Allowed URL schemes
- `accepted()` - Accepted status codes

See the [ClientBuilder documentation](https://docs.rs/lychee-lib/latest/lychee_lib/struct.ClientBuilder.html) for all available options.

## Examples

### Checking Multiple URLs

```rust title="main.rs"
use lychee_lib::{ClientBuilder, Result};

#[tokio::main]
async fn main() -> Result<()> {
    let client = ClientBuilder::default().client()?;
    
    let urls = vec![
        "https://github.com/lycheeverse/lychee",
        "https://docs.rs/lychee-lib",
        "https://lychee.cli.rs",
    ];
    
    for url in urls {
        let response = client.check(url).await?;
        println!("{}: {:?}", url, response.status());
    }
    
    Ok(())
}
```

### Handling Different Response Types

```rust title="main.rs"
use lychee_lib::{ClientBuilder, Result, Status};

#[tokio::main]
async fn main() -> Result<()> {
    let client = ClientBuilder::default().client()?;
    let response = client.check("https://example.com").await?;
    
    match response.status() {
        Status::Ok(_) => println!("✓ Link is valid"),
        Status::Redirected(code) => println!("→ Link redirects with status {}", code),
        Status::Timeout(_) => println!("⏱ Request timed out"),
        Status::Excluded => println!("− Link was excluded by filters"),
        _ => println!("✗ Link check failed: {:?}", response.status()),
    }
    
    Ok(())
}
```

### Using GitHub Token

```rust title="main.rs"
use lychee_lib::{ClientBuilder, Result};
use std::env;

#[tokio::main]
async fn main() -> Result<()> {
    let github_token = env::var("GITHUB_TOKEN").ok();
    
    let client = ClientBuilder::builder()
        .github_token(github_token)
        .build()
        .client()?;
    
    let response = client
        .check("https://api.github.com/repos/lycheeverse/lychee")
        .await?;
    
    println!("GitHub API: {:?}", response.status());
    Ok(())
}
```

## More Examples

For more examples, check out the [examples folder](https://github.com/lycheeverse/lychee/tree/master/examples) in the lychee repository.
