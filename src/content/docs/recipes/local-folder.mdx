---
title: Checking a Local Folder with URL Remapping
description: Checking a local folder of HTML files which will be uploaded to a particular URL.
---
{/* vim: set syntax=markdown: */}

import { Code } from "@astrojs/starlight/components";

Often, you will want to check a local folder of HTML files before the folder
get uploaded to a website (as part of a static site workflow, for example).
Sometimes, this can be complicated when your local files use fully-qualified
URLs which point to the _future_ locations of your local files after they're
uploaded online.

For instance, you write a new blog post which will be uploaded to
`https://example.com/docs/2025-01-01-post.html`. You might use that URL in
certain places (like permalinks and canonical links), even though the URL
doesn't exist _yet_.
<Code
  code={`<h1>My blog post</h1>
<a href="https://example.com/docs/2025-01-01-post.html">Permalink</a>`}
  lang="html"
  title="docs/2025-01-01-post.html"
/>

This can cause problems for link checking, because lychee would check these
links against the currently-online version of the site&mdash;this could be outdated or
missing newly-added files. To solve this problem, we can tell lychee that
certain online URLs should be *mapped* to certain local folder paths.

[^fully]: A _fully-qualified_ link is one which includes a full scheme and domain name, like `https://example.com/page.html`.

This works by mapping the content's future URLs to local files on your
computer, using lychee's URL remapping feature. For links to these URLs, lychee
will check that the corresponding files exist inside the local directory,
rather than checking the online website.

## Do You Need URL Remapping?

In simple cases, you don't!

By default, lychee can already resolve relative links to adjacent local files.
By adding [`--root-dir`][root-dir], lychee can also resolve root-relative links
(beginning with `/`) to the given root directory. In simple cases, this is all
you need.

Continue reading if:
- you have fully-qualified links to files which exist locally but aren't online yet, or
- your local folder will be uploaded to a _subdirectory_ of the website domain.

[root-dir]: /recipes/root-dir/

## Mapping Remote Domain to a Local Folder

Suppose you have a local directory `out` and this will be uploaded to
the domain *root* at `https://docs.example.com`.

You can map URLs beginning with this domain into the local directory:
```bash
lychee ./out --root-dir ./out --remap "^https://docs\.example\.com file://$(pwd)/out"
```
This will remap URLs so `https://docs.example.com/page.html` becomes
`./out/page.html`, for example.

:::caution[Caveats when using remaps]
- For each URL, remaps are tried in order and the *first* matching
  remap will be applied. If you are using remaps for multiple purposes, be aware
  of potential conflicts between them.

- Remaps are applied textually. For instance, `--remap 'https://example\.com/a
  file://tmp` would also apply to a URL of `https://example.com/ab`. This is
  undesirable but safely excluding this is very hard. Using regex's `$` would
  conflict with `#fragments` or `?query` parameters, and appending a `/` would
  cause the URL without a slash to be missed.

- Remap patterns are regular expressions, so `.` in domain names should be
  escaped to avoid matching more than you expect.
:::

## Mapping a Remote Subfolder to a Local Folder

If, instead, your local folder will be uploaded to a _subdirectory_ of the website
(rather than the domain root), you will need some more set up.

Suppose that the local directory `out` will be uploaded to a subfolder at
`https://example.com/docs/`.

### Simple cases

### All cases

To make `--root-dir` work in this context, your local folder structure
has to mimic the structure of the remote website. For example, you can set up
the following folder structure by using symbolic links:
```
├── out
│   └── page.html
└── temp-root-dir
    └── docs -> ../out
```
```bash
mkdir temp-root-dir
ln -s ../out temp-root-dir/docs
```

Additionally, since the local folder is only a subset of the website, certain
relative links should be treated as links to the online website (for example,
the root link `/`). In effect, this means that paths inside `./temp-root-dir`
but outside of `./temp-root-dir/docs` must be redirected to the online website.

Putting it all together, the lychee command looks like this:
```bash
lychee ./out \
  --root-dir ./temp-root-dir \
  --remap "https://example\.com/docs file://$(pwd)/out" \
  --remap "file://$(pwd)/temp-root-dir/docs file://$(pwd)/temp-root-dir/docs" \
  --remap "file://$(pwd)/temp-root-dir https://example\.com"
```
Note that the `temp-root-dir` is only needed for `--root-dir`, and that the
order of remaps is significant&mdash;earlier remaps are tried first and have
priority over later ones.

## See Also

If your URLs make use of automatic index files or automatic file extensions, see
[Pretty URLs](/recipes/pretty-urls/) to enable the same features for local
files.

This documentation page was motivated by certain issue reports
([#1918](https://github.com/lycheeverse/lychee/issues/1918),
[#1594](https://github.com/lycheeverse/lychee/issues/1594)).
In particular, the UX/documentation issue was discussed in
[#1718](https://github.com/lycheeverse/lychee/issues/1718).

